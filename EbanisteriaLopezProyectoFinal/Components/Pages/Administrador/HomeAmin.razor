@page "/admin/home"
@using EbanisteriaLopezProyectoFinal.Components.Services
@inject ProductoService ProductoService
@inject CotizacionService CotizacionService
@inject ClienteService ClienteService
@inject NavigationManager NavigationManager
@inject IJSRuntime JSRuntime

<PageTitle>Panel de Administración - Ebanisteria Lopez</PageTitle>

<div class="admin-wrapper py-5">
    <div class="container admin-container bg-white shadow-lg p-4 p-lg-5 rounded-3">

        <AuthorizeView Roles="Admin">
            <Authorized>
                <div class="admin-header text-center mb-5 pb-3 border-bottom">
                    <h1 class="display-4 fw-bold text-dark">
                        <i class="bi bi-person-workspace me-3 text-primary"></i>Panel de Control Administrativo
                    </h1>
                    <p class="lead text-secondary">Gestiona tu negocio de Ebanistería Lopez con precisión y eficiencia.</p>
                </div>

                <div class="row g-4 mb-5">
                    <div class="col-md-6 col-lg-3">
                        <div class="admin-card card h-100 shadow-sm border-primary">
                            <div class="card-body text-center">
                                <i class="bi bi-box-seam display-4 text-primary mb-3"></i>
                                <h5 class="card-title fw-bold text-dark">Productos</h5>
                                <p class="card-text text-muted">Añade, edita y organiza tu catálogo de productos.</p>
                                <a href="/admin/gestion-productos" class="btn btn-primary mt-3 w-100">
                                    Gestionar Productos <i class="bi bi-arrow-right"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-3">
                        <div class="admin-card card h-100 shadow-sm border-success">
                            <div class="card-body text-center">
                                <i class="bi bi-receipt display-4 text-success mb-3"></i>
                                <h5 class="card-title fw-bold text-dark">Pedidos</h5>
                                <p class="card-text text-muted">Revisa y procesa todas las órdenes de tus clientes.</p>
                                <a href="/admin/orders" class="btn btn-success mt-3 w-100">
                                    Gestionar Pedidos <i class="bi bi-arrow-right"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-3">
                        <div class="admin-card card h-100 shadow-sm border-warning">
                            <div class="card-body text-center">
                                <i class="bi bi-people display-4 text-warning mb-3"></i>
                                <h5 class="card-title fw-bold text-dark">Usuarios</h5>
                                <p class="card-text text-muted">Administra los roles y permisos de los usuarios.</p>
                                <a href="/admin/clientes" class="btn btn-warning mt-3 w-100">
                                    Gestionar Usuarios <i class="bi bi-arrow-right"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-3">
                        <div class="admin-card card h-100 shadow-sm border-info">
                            <div class="card-body text-center">
                                <i class="bi bi-sliders display-4 text-info mb-3"></i>
                                <h5 class="card-title fw-bold text-dark">Ajustes</h5>
                                <p class="card-text text-muted">Configura las opciones generales de tu tienda.</p>
                                <a href="/admin/settings" class="btn btn-info mt-3 w-100">
                                    Configuración <i class="bi bi-arrow-right"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                   
                    <div class="col-md-6 col-lg-3">
                        <div class="admin-card card h-100 shadow-sm border-danger">
                            <div class="card-body text-center">
                                <i class="bi bi-file-earmark-text display-4 text-danger mb-3"></i>
                                <h5 class="card-title fw-bold text-dark">Cotizaciones</h5>
                                <p class="card-text text-muted">Gestiona solicitudes y genera cotizaciones para tus clientes.</p>
                                <a href="/admin/cotizaciones" class="btn btn-danger mt-3 w-100">
                                    Ver Cotizaciones <i class="bi bi-arrow-right"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="admin-quick-stats text-center mt-5 pt-4 border-top">
                    <h2 class="h3 fw-bold text-dark mb-4">Estadísticas Rápidas</h2>
                    <div class="row justify-content-center g-4">
                        <div class="col-sm-6 col-md-4 col-lg-3">
                            <div class="stat-box p-4 rounded-3 shadow-sm bg-light-primary">
                                <i class="bi bi-bag-check display-5 text-primary mb-2"></i>
                                <p class="mb-0 fw-bold h4 text-primary">15</p>
                                <p class="text-muted small">Pedidos Pendientes</p>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-4 col-lg-3">
                            <div class="stat-box p-4 rounded-3 shadow-sm bg-light-success">
                                <i class="bi bi-box display-5 text-success mb-2"></i>
                                <p class="mb-0 fw-bold h4 text-success">234</p>
                                <p class="text-muted small">Productos en Stock</p>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-4 col-lg-3">
                            <div class="stat-box p-4 rounded-3 shadow-sm bg-light-warning">
                                <i class="bi bi-people display-5 text-warning mb-2"></i>
                                <p class="mb-0 fw-bold h4 text-warning">@totalClientes</p>
                                <p class="text-muted small">Clientes Registrados</p>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-4 col-lg-3">
                            <a href="/admin/cotizaciones" class="text-decoration-none">
                                <div class="stat-box p-4 rounded-3 shadow-sm bg-light-danger">
                                    <i class="bi bi-file-earmark-text display-5 text-danger mb-2"></i>
                                    <p class="mb-0 fw-bold h4 text-danger">@totalCotizaciones</p>
                                    <p class="text-muted small">Cotizaciones Activas</p>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

            </Authorized>
            <NotAuthorized>
                <div class="alert alert-danger text-center p-4" role="alert">
                    <h2 class="alert-heading"><i class="bi bi-shield-lock me-2"></i>Acceso Restringido</h2>
                    <p class="mb-0">No tienes los permisos necesarios para ver esta página. Por favor, inicia sesión con una cuenta de administrador.</p>
                </div>
            </NotAuthorized>
        </AuthorizeView>
    </div>
</div>

@code {
    private int totalCotizaciones;
    private int totalClientes;

    protected override async Task OnInitializedAsync()
    {
        totalCotizaciones = await CotizacionService.ContarCotizaciones();
        totalClientes = await ClienteService.ContarClientesAsync();
    }
}
